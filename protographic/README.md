# Protographic

A tool for converting GraphQL Schema Definition Language (SDL) to Protocol Buffers and mapping files.

## Overview

Protographic is a specialized utility that addresses the challenge of translating between GraphQL and Protocol Buffers (protobuf) ecosystems. It provides two primary functions:

1. **GraphQL SDL to Protocol Buffer (Proto) Compiler**: Converts GraphQL schema definitions to Proto3 format, enabling GraphQL services to be exposed via gRPC.

2. **GraphQL SDL to Mapping Compiler**: Generates mapping definitions that preserve the semantic relationships between GraphQL types while adapting them to Proto's structural requirements.

## Key Features

- Accurate conversion of GraphQL types to Protocol Buffer messages
- Consistent naming conventions between GraphQL and Proto definitions
- Support for GraphQL operations mapping to RPC methods
- Handling of complex GraphQL features like unions, interfaces, and directives
- Federation entity mapping support

## Installation

```bash
npm install @wundergraph/protographic
```

## Usage

### Converting GraphQL SDL to Protocol Buffer

```typescript
import { compileGraphQLToProto } from '@wundergraph/protographic';

const graphqlSchema = `
type User {
  id: ID!
  name: String!
}

type Query {
  user(id: ID!): User
}
`;

const protoOutput = compileGraphQLToProto(
  graphqlSchema, // String or GraphQLSchema object
  'UserService', // Service name
  'user.v1', // Package name
  'comso/pkg/my_package' // Go package name 
);
```

### Generating Mapping Definitions

```typescript
import { compileGraphQLToMapping } from '@wundergraph/protographic';
import fs from 'fs';

const graphqlSchema = `
type Product @key(fields: "id") {
  id: ID!
  name: String!
  price: Float!
}

type Query {
  product(id: ID!): Product
}
`;


const mappingOutput = compileGraphQLToMapping(
    graphqlSchema, // String or GraphQLSchema object
    'ProductService', // Service name
);
```

## Conversion Rules

Protographic follows a set of conventions when converting GraphQL SDL to Protocol Buffers. Please take a look at the following rules:

1. GraphQL SDL to Mapping, see [SDL_MAPPING_RULES.md](SDL_MAPPING_RULES.md)
2. GraphQL SDL to Proto, see [PROTO_MAPPING_RULES.md](SDL_PROTO_RULES.md)

## Integration with graphql-go-tools

Protographic's mapping functionality is integrated with [graphql-go-tools](https://github.com/wundergraph/graphql-go-tools) to enable seamless conversion between GraphQL and Protocol Buffer requests. This integration allows GraphQL APIs to be exposed as gRPC services without writing custom transformation code.

The mapping definitions generated by Protographic provide the structural information needed for graphql-go-tools to:
- Convert incoming GraphQL queries to appropriate Protocol Buffer messages
- Transform Protocol Buffer responses back to the expected GraphQL response format
- Handle complex GraphQL features like fragments, variables, and aliases in a Protocol Buffer context

This bidirectional translation layer maintains the type safety and performance benefits of both GraphQL and gRPC ecosystems.

## Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

## License

This project is licensed under the Apache-2.0 License.
